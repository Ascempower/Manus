/* eslint-disable testing-library/render-result-naming-convention */

import { es } from 'date-fns/locale';
import { DayPickerProps } from 'DayPicker';

import { renderDayPickerHook } from 'test/render';
import { freezeBeforeAll } from 'test/utils';

import { CaptionLayout } from 'components/Caption';
import { DayPickerContextValue, useDayPicker } from 'contexts/DayPicker';
import {
  DefaultContextProps,
  getDefaultContextValues
} from 'contexts/DayPicker/defaultContextValues';
import { DaySelectionMode } from 'types/DayPickerBase';
import { Formatters } from 'types/Formatters';
import { Labels } from 'types/Labels';
import { DayModifiers, ModifiersClassNames } from 'types/Modifiers';
import { ClassNames, Styles } from 'types/Styles';

const today = new Date(2022, 5, 13);
const defaults = getDefaultContextValues();

freezeBeforeAll(today);

function renderHook(props?: DayPickerProps) {
  return renderDayPickerHook<DayPickerContextValue>(useDayPicker, props);
}

describe(&apos;when rendered without props&apos;, () => {
  const testPropNames = Object.keys(defaults).filter(
    (key) => key !== &apos;today&apos;
  ) as DefaultContextProps[];
  test.each(testPropNames)(&apos;should use the %s default value&apos;, (propName) => {
    const result = renderHook();
    expect(result.current[propName]).toEqual(defaults[propName]);
  });
});
describe(&apos;when passing &quot;locale&quot; from props&apos;, () => {
  const locale = es;
  test(&apos;should return the custom locale&apos;, () => {
    const result = renderHook({ locale });
    expect(result.current.locale).toBe(locale);
  });
});

describe(&apos;when passing &quot;numberOfMonths&quot; from props&apos;, () => {
  const numberOfMonths = 4;
  test(&apos;should return the custom numberOfMonths&apos;, () => {
    const result = renderHook({ numberOfMonths });
    expect(result.current.numberOfMonths).toBe(4);
  });
});

describe(&apos;when passing &quot;today&quot; from props&apos;, () => {
  const today = new Date(2010, 9, 11);
  test(&apos;should return the custom &quot;today&quot;&apos;, () => {
    const result = renderHook({ today });
    expect(result.current.today).toBe(today);
  });
});

describe(&apos;when passing &quot;captionLayout&quot; from props&apos;, () => {
  const captionLayout: CaptionLayout = &apos;dropdown&apos;;
  const fromYear = 2000;
  const toYear = 2010;
  const dayPickerProps: DayPickerProps = { captionLayout, fromYear, toYear };
  test(&apos;should return the custom &quot;captionLayout&quot;&apos;, () => {
    const result = renderHook(dayPickerProps);
    expect(result.current.captionLayout).toBe(captionLayout);
  });
});

describe(&apos;when &quot;fromDate&quot; and &quot;toDate&quot; are undefined&apos;, () => {
  const fromDate = undefined;
  const toDate = undefined;
  describe(&apos;when using &quot;dropdown&quot; as &quot;captionLayout&quot;&apos;, () => {
    const captionLayout: CaptionLayout = &apos;dropdown&apos;;
    test(&apos;should return &quot;buttons&quot; as &quot;captionLayout&quot;&apos;, () => {
      const result = renderHook({
        fromDate,
        toDate,
        captionLayout
      });
      expect(result.current.captionLayout).toBe(&apos;buttons&apos;);
    });
  });
});

describe(&apos;when &quot;fromDate&quot; is undefined, but not &quot;toDate&quot;&apos;, () => {
  const fromDate = undefined;
  const toDate = new Date();

  describe(&apos;when using &quot;dropdown&quot; as &quot;captionLayout&quot;&apos;, () => {
    const captionLayout: CaptionLayout = &apos;dropdown&apos;;
    test(&apos;should return &quot;buttons&quot; as &quot;captionLayout&quot;&apos;, () => {
      const result = renderHook({
        fromDate,
        toDate,
        captionLayout
      });
      expect(result.current.captionLayout).toBe(&apos;buttons&apos;);
    });
  });
});

describe(&apos;when &quot;toDate&quot; is undefined, but not &quot;fromDate&quot;&apos;, () => {
  const fromDate = new Date();
  const toDate = undefined;

  describe(&apos;when using &quot;dropdown&quot; as &quot;captionLayout&quot;&apos;, () => {
    const captionLayout: CaptionLayout = &apos;dropdown&apos;;
    test(&apos;should return &quot;buttons&quot; as &quot;captionLayout&quot;&apos;, () => {
      const result = renderHook({
        fromDate,
        toDate,
        captionLayout
      });
      expect(result.current.captionLayout).toBe(&apos;buttons&apos;);
    });
  });
});

describe(&apos;when using &quot;dropdown&quot; as &quot;captionLayout&quot;&apos;, () => {
  const captionLayout: CaptionLayout = &apos;dropdown&apos;;
  const fromYear = 2000;
  const toYear = 2010;
  test(&apos;should return the custom &quot;captionLayout&quot;&apos;, () => {
    const result = renderHook({ captionLayout, fromYear, toYear });
    expect(result.current.captionLayout).toBe(captionLayout);
  });
});

describe(&apos;when passing &quot;modifiers&quot; from props&apos;, () => {
  const modifiers: DayModifiers = { foo: new Date() };
  test(&apos;should return the custom &quot;modifiers&quot;&apos;, () => {
    const result = renderHook({ modifiers });
    expect(result.current.modifiers).toStrictEqual(modifiers);
  });
});

describe(&apos;when passing &quot;modifiersClassNames&quot; from props&apos;, () => {
  const modifiersClassNames: ModifiersClassNames = { foo: &apos;bar&apos; };
  test(&apos;should return the custom &quot;modifiersClassNames&quot;&apos;, () => {
    const result = renderHook({ modifiersClassNames });
    expect(result.current.modifiersClassNames).toStrictEqual(
      modifiersClassNames
    );
  });
});

describe(&apos;when passing &quot;styles&quot; from props&apos;, () => {
  const styles: Styles = { caption: { color: &apos;red &apos; } };
  test(&apos;should include the custom &quot;styles&quot;&apos;, () => {
    const result = renderHook({ styles });
    expect(result.current.styles).toStrictEqual({
      ...defaults.styles,
      ...styles
    });
  });
});

describe(&apos;when passing &quot;classNames&quot; from props&apos;, () => {
  const classNames: ClassNames = { caption: &apos;foo&apos; };
  test(&apos;should include the custom &quot;classNames&quot;&apos;, () => {
    const result = renderHook({ classNames });
    expect(result.current.classNames).toStrictEqual({
      ...defaults.classNames,
      ...classNames
    });
  });
});

describe(&apos;when passing &quot;formatters&quot; from props&apos;, () => {
  const formatters: Partial<Formatters> = { formatCaption: jest.fn() };
  test(&apos;should include the custom &quot;formatters&quot;&apos;, () => {
    const result = renderHook({ formatters });
    expect(result.current.formatters).toStrictEqual({
      ...defaults.formatters,
      ...formatters
    });
  });
});

describe(&apos;when passing &quot;labels&quot; from props&apos;, () => {
  const labels: Partial<Labels> = { labelDay: jest.fn() };
  test('should include the custom "labels"', () => {
    const result = renderHook({ labels });
    expect(result.current.labels).toStrictEqual({
      ...defaults.labels,
      ...labels
    });
  });
});

describe('when passing an "id" from props', () => {
  test('should return the id', () => {
    const result = renderHook({ id: 'foo' });
    expect(result.current.id).toBe('foo');
  });
});

describe('when in selection mode', () => {
  const mode: DaySelectionMode = 'multiple';
  const onSelect = jest.fn();
  test('should return the "onSelect" event handler', () => {
    const result = renderHook({ mode, onSelect });
    expect(result.current.onSelect).toBe(onSelect);
  });
});
